extends ../../../views/layout


block content
  - const activeSort = orderBy || 'opportunityScore';
  div(class="space-y-8")
    div(class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between")
      div(class="space-y-2")
        h1(class="text-3xl font-semibold text-gray-900") Keyword Intelligence
        p(class="text-gray-600") Understand opportunity, intent, and ranking coverage across your priority queries.
      form(method="get" action="/reverb/keywords" class="inline-flex items-center gap-3")
        label(for="reverb-sort" class="text-xs uppercase tracking-[0.3em] text-gray-500") Sort by
        select#reverb-sort(name="sort" class="rounded-xl border border-gray-200 bg-white px-3 py-2 text-sm text-gray-700 focus:outline-none focus:ring-2 focus:ring-purple-500")
          option(value="opportunityScore" selected=activeSort === 'opportunityScore') Opportunity score
          option(value="searchVolume" selected=activeSort === 'searchVolume') Search volume
          option(value="difficulty" selected=activeSort === 'difficulty') Difficulty (asc)
          option(value="currentRank" selected=activeSort === 'currentRank') Current rank
        button(type="submit" class="inline-flex items-center rounded-2xl bg-purple-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2") Apply


    if summary && summary.totalTracked
      div(class="grid grid-cols-1 md:grid-cols-4 gap-4")
        div(class="rounded-3xl bg-white ring-1 ring-gray-200 shadow-sm p-5")
          p(class="text-xs uppercase tracking-[0.3em] text-gray-500") Total tracked
          p(class="text-3xl font-semibold text-gray-900") #{summary.totalTracked}
        div(class="rounded-3xl bg-white ring-1 ring-gray-200 shadow-sm p-5")
          p(class="text-xs uppercase tracking-[0.3em] text-gray-500") Avg difficulty
          p(class="text-3xl font-semibold text-amber-600") #{summary.averageDifficulty}
        div(class="rounded-3xl bg-white ring-1 ring-gray-200 shadow-sm p-5")
          p(class="text-xs uppercase tracking-[0.3em] text-gray-500") Avg opportunity
          p(class="text-3xl font-semibold text-emerald-600") #{summary.averageOpportunity}
        if summary.topOpportunity
          div(class="rounded-3xl bg-white ring-1 ring-gray-200 shadow-sm p-5")
            p(class="text-xs uppercase tracking-[0.3em] text-gray-500") Top opportunity
            p(class="text-sm font-semibold text-purple-700 truncate") #{summary.topOpportunity.keyword}

    div(class="bg-white rounded-3xl shadow-sm ring-1 ring-gray-200 overflow-hidden")
      table(class="min-w-full text-sm text-gray-700")
        thead(class="bg-gray-50 text-gray-500 uppercase text-xs")
          tr
            th(class="px-6 py-3 text-left font-semibold tracking-wide") Keyword
            th(class="px-6 py-3 text-left font-semibold tracking-wide") Intent
            th(class="px-6 py-3 text-left font-semibold tracking-wide") Opportunity
            th(class="px-6 py-3 text-left font-semibold tracking-wide") Search volume
            th(class="px-6 py-3 text-left font-semibold tracking-wide") Difficulty
            th(class="px-6 py-3 text-left font-semibold tracking-wide") Rank
            th(class="px-6 py-3 text-left font-semibold tracking-wide") Ranking URL
        tbody(class="divide-y divide-gray-100 bg-white")
          if insights && insights.length
            each keyword in insights
              tr(class="hover:bg-gray-50 transition")
                td(class="px-6 py-3 font-medium text-gray-900") #{keyword.keyword}
                td(class="px-6 py-3 capitalize") #{keyword.intent}
                td(class="px-6 py-3")
                  span(class="inline-flex items-center rounded-full bg-purple-50 px-3 py-1 text-xs font-semibold text-purple-700") #{keyword.opportunityScore}
                td(class="px-6 py-3") #{keyword.searchVolume}
                td(class="px-6 py-3") #{keyword.difficulty}
                td(class="px-6 py-3") #{keyword.currentRank || '—'}
                td(class="px-6 py-3")
                  if keyword.rankingUrl
                    a(href=keyword.rankingUrl class="text-purple-600 hover:text-purple-500 truncate block" target="_blank" rel="noopener noreferrer") #{keyword.rankingUrl}
                  else
                    span(class="text-gray-400") —
          else
            tr
              td(colspan="7" class="px-6 py-6 text-center text-sm text-gray-500") No keyword intelligence data available.




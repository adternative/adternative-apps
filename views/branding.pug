extends frame

block pageContent
  // Header
  div(class="mb-8")
    h2(class="text-2xl font-bold text-gray-900") Branding
    p(class="text-gray-600") Upload and organize your brand assets

  // Upload section - Modern drag & drop with preview
  div(class="bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-8")
    h3(class="text-lg font-semibold text-gray-900 mb-6") Upload Asset
    
    // Category selector - Simple dropdown
    div(class="mb-6")
      label(class="block text-sm font-medium text-gray-700 mb-2") Category
      div(class="relative")
        button(id="branding_category_button" type="button" class="w-full md:w-auto min-w-[280px] flex items-center justify-between px-4 py-2.5 bg-white border border-gray-300 rounded-lg hover:border-teal-400 focus:outline-none focus:ring-2 focus:ring-teal-400")
          span(id="branding_category_display" class="flex items-center gap-2")
            i(id="branding_category_icon" data-lucide="file" class="w-4 h-4")
            span(id="branding_category_text") Miscellaneous
          i(data-lucide="chevron-down" class="w-4 h-4 text-gray-400")
        
        div(id="branding_category_dropdown" class="hidden absolute z-50 mt-1 w-full md:w-auto min-w-[280px] bg-white border border-gray-200 rounded-lg shadow-lg overflow-hidden")
          button(type="button" data-category="logo" data-icon="sparkles" class="category-option w-full flex items-center gap-3 px-4 py-2.5 hover:bg-gray-50")
            i(data-lucide="sparkles" class="w-4 h-4 text-teal-500")
            span Logo
          button(type="button" data-category="fonts" data-icon="type" class="category-option w-full flex items-center gap-3 px-4 py-2.5 hover:bg-gray-50")
            i(data-lucide="type" class="w-4 h-4 text-purple-500")
            span Fonts
          button(type="button" data-category="photos" data-icon="camera" class="category-option w-full flex items-center gap-3 px-4 py-2.5 hover:bg-gray-50")
            i(data-lucide="camera" class="w-4 h-4 text-blue-500")
            span Photos
          button(type="button" data-category="graphics" data-icon="palette" class="category-option w-full flex items-center gap-3 px-4 py-2.5 hover:bg-gray-50")
            i(data-lucide="palette" class="w-4 h-4 text-pink-500")
            span Graphics
          button(type="button" data-category="videos" data-icon="video" class="category-option w-full flex items-center gap-3 px-4 py-2.5 hover:bg-gray-50")
            i(data-lucide="video" class="w-4 h-4 text-red-500")
            span Videos
          button(type="button" data-category="misc" data-icon="file" class="category-option w-full flex items-center gap-3 px-4 py-2.5 hover:bg-gray-50")
            i(data-lucide="file" class="w-4 h-4 text-gray-500")
            span Miscellaneous
        
        select(id="branding_category" class="hidden")
          option(value="logo") Logo
          option(value="fonts") Fonts
          option(value="photos") Photos
          option(value="graphics") Graphics
          option(value="videos") Videos
          option(value="misc" selected) Miscellaneous
    
    // Drag & drop area
    div(id="branding_upload_zone" class="relative border-2 border-dashed border-gray-300 rounded-xl p-8 transition-all hover:border-teal-400 hover:bg-teal-50/30 cursor-pointer group")
      input(type="file" id="branding_file" accept="image/*,video/*,application/pdf,font/*" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer z-0")
      
      // Default state
      div(id="branding_upload_default" class="text-center")
        div(class="flex flex-col items-center justify-center space-y-4")
          div(class="w-16 h-16 rounded-full bg-gradient-to-br from-teal-400 to-purple-500 flex items-center justify-center group-hover:scale-110 transition-transform")
            i(data-lucide="upload-cloud" class="w-8 h-8 text-white")
          div
            p(class="text-gray-900 font-medium text-lg") Drop files here or click to browse
            p(class="text-gray-500 text-sm mt-1") Supports images, videos, PDFs, and fonts
      
      // Preview state (hidden by default)
      div(id="branding_upload_preview" class="hidden relative z-20")
        div(id="branding_preview_content")
          // Preview will be inserted here by JavaScript
        div(class="flex items-center justify-end space-x-3 mt-4 relative z-30")
          button(id="branding_cancel_btn" type="button" class="px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium transition-colors cursor-pointer") Cancel
          button(id="branding_upload_btn" type="button" class="px-6 py-2 bg-gradient-to-r from-teal-400 to-purple-500 text-white rounded-lg font-medium hover:shadow-lg transition-all transform hover:scale-105 flex items-center space-x-2 cursor-pointer")
            i(data-lucide="upload" class="w-4 h-4")
            span Upload Asset

  // Categories and assets
  div(id="branding_assets_container")
    // Assets will be loaded here by JavaScript
    div(class="text-center text-gray-500 py-8")
      | Loading assets...

  // Replace logo confirmation modal
  div(id="replace_logo_modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 z-50 hidden")
    div(class="flex items-center justify-center min-h-screen p-4")
      div(class="bg-white rounded-lg shadow-xl max-w-md w-full p-6")
        h3(class="text-lg font-medium text-gray-900 mb-4") Replace Current Logo?
        p(class="text-gray-600 mb-6") You're uploading a new logo. Do you want to replace the current entity logo with this one?
        div(class="flex justify-end space-x-3")
          button(id="replace_logo_cancel" class="inline-flex items-center justify-center px-4 py-2 rounded-lg font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 bg-gray-200 text-gray-800 hover:bg-gray-300 focus:ring-gray-500") Cancel
          button(id="replace_logo_no" class="inline-flex items-center justify-center px-4 py-2 rounded-lg font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 bg-gray-200 text-gray-800 hover:bg-gray-300 focus:ring-gray-500") No, Keep Current
          button(id="replace_logo_yes" class="inline-flex items-center justify-center px-4 py-2 rounded-lg font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 bg-teal-400 text-white hover:bg-purple-900 focus:ring-purple-500") Yes, Replace

  // Expose entity ID to JavaScript
  if typeof selectedEntityId !== 'undefined' && selectedEntityId
    script.
      window.__SELECTED_ENTITY_ID__ = '!{selectedEntityId}';
      try { 
        if (!localStorage.getItem('currentEntityId') && window.__SELECTED_ENTITY_ID__) { 
          localStorage.setItem('currentEntityId', window.__SELECTED_ENTITY_ID__); 
        } 
      } catch (e) {}
  script(src="/javascripts/branding.js")

